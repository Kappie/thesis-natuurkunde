\chapterprecishere{abstract}

\section{At the critical point}

\subsection{Existence of two length scales}

First, we reproduce the results presented in \cite{nishino1996numerical} to validate the assumption that at the critical
point, the only relevant length scales are the system size $N$ and the length scale associated to a finite dimension $m$
of the corner transfer matrix $\xi(m)$.
Here, we assume that $\xi(m)$ is given by the correlation length at the critical point,
see \autoref{sec:definition_effective_length_scale_in_terms_of_xi}.

The order parameter should obey the following scaling relation at
the critical temperature
\begin{equation}\label{eq:order_param_scaling_relation_finite_m}
  M(T = T_c, m) \propto \xi(T = T_c, m)^{-\beta/\nu}.
\end{equation}
The left panel of \autoref{fig:order_parameter_power_law_fit} shows that this scaling
relation holds. The fit yields $\frac{\beta}{\nu} \approx 0.125(5)$, close to the true
value of $\frac{1}{8}$.

The right panel shows the conventional finite-size scaling relation
\begin{equation}\label{eq:order_param_scaling_relation_finite_N}
  M(T = T_c, N) \propto N^{-\beta/\nu},
\end{equation}
yielding $\beta/\nu \approx 0.1249(1)$.

The correlation length $\xi(m)$ shows characteristic half-moon patterns on a
log-log scale, stemming from the degeneracies in the corner transfer matrix spectrum. This
makes the data harder to interpret, since the effect of increasing $m$ depends on how much
of the spectrum is currently retained.

\todo[inline]{Talk about how to alleviate this partially by using entropy $S$ as
length scale.}

\begin{figure}
  % \includegraphics[width=\textwidth, axisratio=1]{order_parameter_power_law_fit.tikz}
  \includegraphics[]{order_parameter_power_law_fit.tikz}
  \caption{Left panel: fit to the relation in
  \autoref{eq:order_param_scaling_relation_finite_m}, yielding $\frac{\beta}{\nu} \approx
  0.125(5)$. The data points are obtained from simulations with $m = 2, 4, \dots, 64$. The
  smallest 10 values of $m$ have not been used for fitting, to diminish correction terms
  to the basic scaling law. Right panel: fit to conventional finite-size scaling law
  given in \autoref{eq:order_param_scaling_relation_finite_N}.
  }
  \label{fig:order_parameter_power_law_fit}
\end{figure}

To further test the hypothesis that $N$ and $\xi(m)$ are the only relevant length scales,
the authors of \cite{nishino1996numerical} propose a scaling relation for the order
parameter $M$ at the critical temperature of the form
\begin{equation}\label{eq:order_param_scaling_relation}
  M(N, m) = N^{-\beta/\nu} \mathcal{G}(\xi(m) / N)
\end{equation}
with
\begin{equation}
  \mathcal{G}(x) =
  \begin{cases}
    \text{const} & \text{if } x \to \infty, \\
    x^{-\beta/\nu} & \text{if } x \to 0,
  \end{cases}
\end{equation}
meaning that \autoref{eq:order_param_scaling_relation} reduces to
\autoref{eq:order_param_scaling_relation_finite_N} in the limit $\xi(m) \gg N$ and to
\autoref{eq:order_param_scaling_relation_finite_m} in the limit $N \gg \xi(m)$.
\autoref{fig:data_collapse_nishino} shows that the scaling relation of \autoref{eq:order_param_scaling_relation}
is justified.

\autoref{fig:crossover_nishino} shows the cross-over behaviour from the $N$-limiting regime, where
$M(N, m) \propto N^{-\beta/\nu}$ to the $\xi(m)$-limiting regime, where $M(N, m)$ does not depend on $N$.

\begin{figure}
  \includegraphics[]{data_collapse_nishino.tikz}
  \caption{Scaling function $\mathcal{G}(\xi(m)/N)$ given in
  \autoref{eq:order_param_scaling_relation}.}\label{fig:data_collapse_nishino}
\end{figure}

\begin{figure}
  \includegraphics[]{crossover_nishino.tikz}
  \caption{Behaviour of the order parameter at fixed $m$ as function of
  the number of renormalization steps $n$. For small $n$, all curves coincide, since the system size is the only
  limiting length scale. For large enough $n$, the order parameter is only limited by the length scale
  $\xi(m)$. In between, there is a cross-over described by $\mathcal{G}(\xi(m)/N)$, given in
  \autoref{eq:order_param_scaling_relation}.}\label{fig:crossover_nishino}
\end{figure}

\subsection{Central charge}
We may directly verify the value of the central charge $c$ associated with the conformal field theory at the critical
point by fitting to
\begin{equation}\label{eq:entropy_vs_correlation_length}
  S_{\text{classical}} \propto \frac{c}{6} \log \xi(m),
\end{equation}
which yields $c = 0.501$, shown in the left panel of \autoref{fig:entropy_vs_correlation_length}.

The right panel of \autoref{fig:entropy_vs_correlation_length} shows the fit to the scaling relation in $N$ (or,
equivalently the number of CTMRG steps $n$)
\begin{equation}\label{eq:entropy_vs_N}
  S_{\text{classical}} \propto \frac{c}{6} \log N,
\end{equation}
which yields $c = 0.498$.

\begin{figure}
  \includegraphics[]{entropy_vs_correlation_length.tikz}
  \caption{Left panel: numerical fit to \autoref{eq:entropy_vs_correlation_length}, yielding $c = 0.501$. Right panel:
  numerical fit to \autoref{eq:entropy_vs_N}, yielding $c = 0.498$. }\label{fig:entropy_vs_correlation_length}
\end{figure}

\subsection{Using the entropy to define the correlation length}\label{sec:entropy_to_define_correlation_length}
Via \autoref{eq:entropy_scaling_near_criticality}, the correlation length is expressed as
\begin{equation}\label{eq:correlation_length_as_function_of_entropy}
  \xi \propto \exp(\frac{6}{c}S).
\end{equation}

\autoref{fig:order_parameter_power_law_fit_entropy} shows the results of fitting the relation in
\autoref{eq:order_param_scaling_relation_finite_m} with this definition of the correlation length. The fit is an order
of magnitude better in the least-squares sense, and the half-moon shapes have almost disappeared,
yielding a much more robust exponent of $\beta/\nu = 0.12498$.

The entropy uses all eigenvalues of the corner transfer matrix, making it apparently less prone to structure in the
spectrum than the correlation length as defined in \autoref{eq:correlation_length_row_to_row_transfer_matrix},
which uses only two eigenvalues of the row-to-row transfer matrix.
Furthermore, the corner transfer matrix $A$ is kept diagonal in the CTMRG algorithm,
so $S$ is much cheaper to compute than $\xi$.

\begin{figure}
  \includegraphics[]{order_parameter_power_law_fit_entropy.tikz}
  \caption{}\label{fig:order_parameter_power_law_fit_entropy}
\end{figure}

\subsection{Exponent $\kappa$}

We now check the validity of the relation
\begin{equation}\label{eq:xi_propto_kappa_2}
  \xi(m) \propto m^{\kappa}
\end{equation}
in the context of the CTMRG method for two-dimensional
classical systems. Similar checks were done for one-dimensional quantum systems in \cite{tagliacozzo2008scaling}.

Let us first state that boundary conditions are relevant.
From (\emph{cite here!!}) we expect that for fixed boundary conditions,
the entropy and therefore the correlation length is lower for a given bond dimension $m$.

There are various ways of extracting the exponent $\kappa$.
\autoref{fig:support_for_kappa} shows the results for fixed boundary conditions and \autoref{fig:support_for_kappa_free}
for free boundary conditions.

Directly checking \autoref{eq:xi_propto_kappa_2} yields $\kappa = 1.93$ for a fixed boundary
and $\kappa = 1.96$ for a free boundary.

Under the assumption of \autoref{eq:xi_propto_kappa_2}, we have the following scaling laws at the critical point
\begin{align}\label{eq:scaling_laws_order_param_free_energy_kappa}
  M(m) & \propto m^{-\beta \kappa / \nu} \\
  f(m) - f_{\text{exact}} & \propto m^{(2-\alpha)\kappa / \nu}
\end{align}
for the order parameter and the singular part of the free energy, respectively.
With a fixed boundary, a fit to $M(m)$ yields $\kappa = 1.93$.
For a free boundary we cannot extract any exponent, since $M = 0$ for every temperature.
A fit to $f(m) - f_{\text{exact}}$ yields $\kappa = 1.90$ for a fixed boundary and $\kappa = 1.93$ for a free boundary.
\autoref{fig:support_for_kappa}. Here, we have used $\beta = 1/8$, $\nu = 1$ and $\alpha = 0$ for the Ising model.
\todo[inline]{Tell that the $\kappa$ law is indeed valid, since it is a good fit.}

We may use \autoref{eq:entropy_scaling_near_criticality} and \autoref{eq:classical_entropy} to check the
relation
\begin{equation}\label{eq:scaling_law_entropy_kappa}
  S_{\text{classical}} \propto \frac{c\kappa}{6}\log m,
\end{equation}
which yields $\kappa = 1.93$ for a fixed boundary and $\kappa = 1.96$ for a free boundary,
with $c = 1/2$ for the Ising model.

\begin{figure}
  \includegraphics[]{support_for_kappa.tikz}
  \caption{Numerical evidence for \autoref{eq:xi_propto_kappa_2}, \autoref{eq:scaling_laws_order_param_free_energy_kappa},
  \autoref{eq:scaling_law_entropy_kappa} with fixed boundary, yielding, from left to right and top to bottom, $\kappa = \{ 1.93, 1.93, 1.90,
  1.93 \}$.}\label{fig:support_for_kappa}
\end{figure}

\begin{figure}
  \includegraphics[]{support_for_kappa_free.tikz}
  \caption{Numerical evidence for \autoref{eq:xi_propto_kappa_2} with free boundary,
  yielding from left to right and then bottom $\kappa = \{ 1.96,
  1.93, 1.96 \}$.}\label{fig:support_for_kappa_free} \end{figure}

\subsubsection{Comparison with exact result in asymptotic limit}

The predicted value for $\kappa$ \cite{pollmann2009theory} is $2.034\dots$ (see also \autoref{eq:exact_value_kappa}).
With the CTMRG method, we extract the slightly lower value of $1.96$ (corresponding to free boundary conditions).
But, the structure in the quantities as function of $m$ makes it hard to get an accurate fit to $\kappa$.

It is interesting to note that for fixed boundary conditions, the relation in \autoref{eq:xi_propto_kappa_2} holds,
but with a lower exponent $\kappa$. This is to be expected, since half the spectrum is missing.
\todo[inline]{phrase this better. Maybe subsubsection?}
\todo[inline]{MUST SAY THAT I LEFT AWAY VALUES OF $m$ in symmetric case!!}

\section{Locating the critical point}\label{sec:locating_the_critical_point}

In general, the critical point is not known, but it may be located using the spectrum of the corner transfer matrix as
described in \autoref{sec:locating_critical_point_entanglement}. For a given value of $m$ (or $N$, in a finite-size approximation), the pseudocritical temperature is defined as the point of maximum entropy.

\autoref{fig:entropy_vs_T} shows the classical analogue to the entanglement entropy as a function of temperature for
different values of $m$.

The critical point is located by fitting the scaling law in \autoref{eq:scaling_law_T_star}.

\subsection{Finite $m$}
For approximations with finite bond dimension $m$, it is not clear what length scale should be used to fit the scaling
behaviour of $T^{\star}(m)$.
\autoref{fig:T_pseudocrit_chi_power_law_fit} shows the results for different choices of this length scale.
To obtain $T^{\star}$, a convergence threshold of $10^{-8}$ and a temperature tolerance of $10^{-6}$ are used.
The boundaries are fixed to $+1$.

\todo[inline]{Maybe I've used a too low TolX??}
\todo[inline]{Explain results here}

We denote the estimated value of the critical temperature as $\widetilde{T_c}$. Recall that the exact value is
\begin{equation}
  T_c = 2.2691853\dots
\end{equation}
and $\nu = 1$.

When using $\xi(T_c, m)$, the correlation length at the exact critical point,
the result shows a lot of structure, yielding $\widetilde{T_c} = 2.269172$ and $\nu = 1.057$.

If, instead, the correlation length at the estimated pseudocritical temperature $\xi(T^{\star}(m))$ is used,
the data shows less structure and we obtain the much more precise results $\widetilde{T_c} = 2.269183$ and $\nu =
1.002$.

Another option is to use the entropy to define the correlation length,
via \autoref{eq:correlation_length_as_function_of_entropy}, which gave more accurate results than using the transfer
matrix definition in \autoref{sec:entropy_to_define_correlation_length}.
In this case, the results are slightly worse than the transfer matrix definition:
$T_c = 2.269183$ and $\nu = 1.02$.

Finally, we may directly fit the law
\begin{equation}
  |T_c - T^{\star}(m)| \propto m^{-\kappa/\nu},
\end{equation}
yielding $T_c = 2.269181$ and $\kappa/\nu = 1.91$.
Incidentally, this is another way to confirm $\kappa \approx 1.9$ for systems with a fixed boundary.

\todo[inline]{Why do length scales defined at $T^{\star}$ work better??
It is fortunate that we don't need the length scales at $T_c$, since we don't know it.}

\subsection{Finite $N$}
As a cross check, we can instead use systems of finite size to extract $T_c$ and $\nu$.
This yields \emph{values}. See the \emph{figure}.

\begin{figure}
  \includegraphics[]{entropy_vs_T.tikz}
  \caption{Classical analogue to the entanglement entropy, as in \autoref{eq:classical_entropy},
  near the critical point (shown as dashed line).}\label{fig:entropy_vs_T}
\end{figure}

\begin{figure}
  \includegraphics[]{T_pseudocrit_chi_power_law_fit.tikz}
  \caption{haloalaoalalalalaalkk}\label{fig:T_pseudocrit_chi_power_law_fit}
\end{figure}

\section{Away from the critical point}

We may also verify the validity of the different length scales by asserting that the data for different values of $m$
should collapse on a single curve
\begin{equation}
  \mathcal{G}(t N_{\text{eff}}(m)^{1/\nu}) = M(T, m) N_{\text{eff}}(m)^{\beta/\nu}.
\end{equation}

All data points were calculated with a convergence threshold of $10^{-7}$.
The values of the pseudocritical temperatures are taken from the results in \autoref{sec:locating_the_critical_point}.
No temperatures beyond $T_c$ is considered because the order parameter drops off sharply,
causing the curve $\mathcal{G}(x)$ to tend to zero almost vertically, making the fitness $P$ unreliable.

\autoref{fig:data_collapse_chi} shows that for all length scales, the results more or less fall on one curve.
\autoref{table:fitness_data_collapse_different_length_scales} shows the fitness of the data collapse
\cite{bhattacharjee2001measure} (given by \autoref{eq:fitness_data_collapse}) for all length scales used.

\todo[inline]{Say which length scales apparently don't work so well}

Using $m^{\kappa}$ as a length scale for optimized fitness $P(\kappa)$ yields $\kappa \approx 1.98$,
substantially higher than found previously for fixed boundary conditions.

As a cross-check, the bottom-right panel of \autoref{fig:data_collapse_chi} shows data points for finite-$N$
simulations. Here, the bond dimension is chosen such that the truncation error is smaller than $10^{-6}$.

\begin{figure}
  \includegraphics[]{data_collapse_chi.tikz}
  \caption{Data collapses using different length scales.
  For the bottom-right plot, approximations with finite $N$ instead of finite $m$ have been used,
  with $n = \{160, 480, 1000, 1500 \}$ ($n = \frac{N - 1}{2}$ is the number of algorithm
  steps).}\label{fig:data_collapse_chi}
\end{figure}

\begin{table}[]
\centering
\begin{tabular}{@{}ll@{}} \toprule
$N_{\text{eff}}$                  & fitness $P$ \\ \midrule
$\xi(T_c, m)$                     & 0.0075      \\
$\xi(T^{\star}(m))$               & 0.066       \\
$\exp((6/c)S(T_c, m))$            & 0.057       \\
$\exp((6/c)S(T^{\star}(m))$       & 0.087       \\
$m^{\kappa}$                      & 0.0080      \\
$N$                               & 0.0075      \\ \bottomrule
\end{tabular}
  \caption{Fitness of data collapse (\autoref{eq:fitness_data_collapse}) for different length scales.
  $\kappa \approx 1.98$ was found to be optimal for the length scale $m^{\kappa}$.}
  \label{table:fitness_data_collapse_different_length_scales}
\end{table}
