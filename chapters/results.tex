\section{Abstract}

\todo[inline]{Cite more}

We present finite-size scaling results using the corner transfer matrix renormalization
group method on two-dimensional classical square lattices \cite{nishino1996corner}. We
compare the results of conventional finite-size scaling in the system size $N$ with
scaling in the number of states kept during the renormalization step of the algorithm,
denoted by $m$. Such a comparison was first done in \cite{nishino1996numerical}. We
highlight the areas in which method excels over the other.

Calculate critical temperature and exponents using information that is directly
extractable from the corner transfer matrix.


\section{Introduction}

The first direct comparison of finite-size scaling in the system size $N$ with scaling in
the bond dimension of the corner transfer matrix renormalization group method $m$ was done
in \cite{nishino1996numerical}. In explaining the basic concepts, we largely follow this
paper.

The error in the approximation of the partition function (and thus all thermodynamic
quantities) in the thermodynamic limit with the corner transfer matrix method depends on
two characteristic length
scales. The first is the size of the system $N$. After $n$ steps of the infinite-system
algorithm, we have
\begin{equation}
  N = 2n + 1.
\end{equation}

The second length scale is related to the finite bond dimension $m$. Baxter
\cite{baxter1978variational}, and later Ã–stlund and Rommer \cite{ostlund1995thermodynamic}
(in the context of one-dimensional quantum systems) showed that in the thermodynamic
limit, CTMRG and DMRG are variational optimizations in the space of matrix product states.
\todo[inline]{Can extend this idea a bit.}

\begin{figure}
\includegraphics[]{order_parameter_vs_T.tikz}
\caption{Upper panel: expectation value of the central spin $\langle \sigma_0 \rangle$
  after $n$ CTMRG steps. $m$ is chosen such that the truncation error is smaller than
  $10^{-6}$. Lower panel: $\langle \sigma_0 \rangle$ for systems with bond dimension $m$.}\label{fig:order_parameter_vs_T}
\end{figure}

It is known that an MPS-ansatz with finite bond dimension inherently limits the
correlation length of the system to a finite value \cite{wolf2006quantum}. Hence,
thermodynamic quantities obtained from the CTMRG algorithm with finite $m$, in the limit
$N \to \infty$, cannot diverge and must show finite-size effects similar to those of some
effective finite system of size $N_{\text{eff}}(m)$ depending on the bond dimension $m$.

\autoref{fig:order_parameter_vs_T} shows the behaviour of the order parameter of the
two-dimensional Ising model for systems of finite-size, where $m$ has been chosen such
that the truncation error is smaller than $10^{-6}$, and for systems of finite $m$, where
the result is converged in the system size $N$. The results look very similar and support
the above claim.

\todo[inline]{Order parameter is not the same as magnetization central spin. Where to
explain this?}

\subsection{Definition of $N_{\text{eff}}$ in terms of the correlation length at $T_c$}

In the thermodynamic limit (corresponding to infinite $m$ and $N$), we have the following
expression for the correlation length of a classical system
\cite{baxter1982exactly_correlation_length}
\begin{equation}
  \xi(T) = \frac{1}{\log\left(\frac{T_0}{T_1}\right)}.
\end{equation}
Here, $T_0$ and $T_1$ are the largest and second-largest eigenvalues of the row-to-row
transfer matrix $T$, respectively. With $N$ tending towards infinity and finite $m$, near
the critical point $\xi(T)$ should obey a scaling law of the form
\begin{equation}
  \xi(T, m) = N_{\text{eff}}(m) \mathcal{F}(N_{\text{eff}}(m) / \xi(T))
\end{equation}
with
\begin{equation}
  \mathcal{F}(x) = \begin{cases}
      \text{const} & \text{if } x \to 0, \\
      x^{-1} & \text{if } x \to \infty.
    \end{cases}
\end{equation}

Hence, the effective length scale corresponding to the finite bond dimension $m$ is
proportional to the correlation length of the system at the critical point $t = 0$.
\begin{equation}
  N_{\text{eff}}(m) \propto \xi(T = T_c, m).
\end{equation}

Under this assumption, the order parameter should obey the following scaling relation at
the critical temperature
\begin{equation}\label{eq:order_param_scaling_relation_finite_m}
  M(T = T_c, m) \propto \xi(T = T_c, m)^{-\beta/\nu}.
\end{equation}
The left panel of \autoref{fig:order_parameter_power_law_fit} shows that this scaling
relation holds. The fit yields $\frac{\beta}{\nu} \approx 0.125(5)$, close to the true
value of $\frac{1}{8}$.

The right panel shows the conventional finite-size scaling relation
\begin{equation}\label{eq:order_param_scaling_relation_finite_N}
  M(T = T_c, N) \propto N^{-\beta/\nu},
\end{equation}
yielding $\beta/\nu \approx 0.1249(1)$, which can be systematically improved by
fitting to larger system sizes, obtained with a fixed truncation error.

In the case of scaling in correlation length $\xi(m)$, the exponent does not improve when
taking bigger values of $m$, while keeping the termination criterion (relative change of
singular values) fixed. This points to a flaw in the termination criterion of the
algorithm.

Furthermore, the correlation length $\xi(m)$ shows characteristic half-moon patterns on a
log-log scale, stemming from the degeneracies in the corner transfer matrix spectrum. This
makes the data harder to interpret, since the effect of increasing $m$ depends on how much
of the spectrum is currently retained.

\todo[inline]{Talk about how to alleviate this partially by using entropy $S$ as
length scale.}

\begin{figure}
  % \includegraphics[width=\textwidth, axisratio=1]{order_parameter_power_law_fit.tikz}
  \includegraphics[]{order_parameter_power_law_fit.tikz}
  \caption{Left panel: fit to the relation in
  \autoref{eq:order_param_scaling_relation_finite_m}, yielding $\frac{\beta}{\nu} \approx
  0.125(5)$. The data points are obtained from simulations with $m = 2, 4, \dots, 64$. The
  smallest 10 values of $m$ have not been used for fitting, to diminish correction terms
  to the basic scaling law. Right panel: fit to conventional finite-size scaling law
  given in \autoref{eq:order_param_scaling_relation_finite_N}.
  }
  \label{fig:order_parameter_power_law_fit}
\end{figure}

To further test the hypothesis that $N$ and $\xi(m)$ are the only relevant length scales,
the authors of \cite{nishino1996numerical} propose a scaling relation for the order
parameter $M$ at the critical temperature of the form
\begin{equation}\label{eq:order_param_scaling_relation}
  M(N, m) = N^{-\beta/\nu} \mathcal{G}(\xi(m) / N)
\end{equation}
with
\begin{equation}
  \mathcal{G}(x) =
  \begin{cases}
    \text{const} & \text{if } x \to \infty, \\
    x^{-\beta/\nu} & \text{if } x \to 0,
  \end{cases}
\end{equation}
meaning that \autoref{eq:order_param_scaling_relation} reduces to
\autoref{eq:order_param_scaling_relation_finite_N} in the limit $\xi(m) \gg N$ and to
\autoref{eq:order_param_scaling_relation_finite_m} in the limit $N \gg \xi(m)$.
\autoref{fig:data_collapse_nishino} shows that the scaling relation of \autoref{eq:order_param_scaling_relation}
is justified.

\autoref{fig:crossover_nishino} shows the cross-over behaviour from the $N$-limiting regime, where
$M(N, m) \propto N^{-\beta/\nu}$ to the $\xi(m)$-limiting regime, where $M(N, m)$ does not depend on $N$.

\begin{figure}
  \includegraphics[]{data_collapse_nishino.tikz}
  \caption{Scaling function $\mathcal{G}(\xi(m)/N)$ given in
  \autoref{eq:order_param_scaling_relation}.}\label{fig:data_collapse_nishino}
\end{figure}

\begin{figure}
  \includegraphics[]{crossover_nishino.tikz}
  \caption{Behaviour of the order parameter at fixed $m$ as function of
  the number of renormalization steps $n$. For small $n$, all curves coincide, since the system size is the only
  limiting length scale. For large enough $n$, the order parameter is only limited by the length scale
  $\xi(m)$. In between, there is a cross-over described by $\mathcal{G}(\xi(m)/N)$, given in
  \autoref{eq:order_param_scaling_relation}.}\label{fig:crossover_nishino}
\end{figure}

\subsection{Scaling relations away from the critical point}
In general, the position of the critical point is not known. In that situation, the scaling relation in
\autoref{eq:order_param_scaling_relation} cannot be used to calculate thermodynamic information. Instead, in the limit
$N \to \infty$, we should have
\begin{equation}\label{eq:order_param_scaling_relation_finite_chi_t}
  M(t, m) \propto \xi(m)^{-\beta/\nu}\mathcal{P}(t \xi(m)^{1/\nu}),
\end{equation}
which is confirmed in \autoref{fig:data_collapse_chi_correlation_length}.

However, in practice this is still problematic, since $\xi(m)$ is defined at the critical point. Thus, we must find a
way to define the length scale corresponding to a finite bond dimension $m$ without making use of the position of the
critical point.

\begin{figure}
  \includegraphics[]{data_collapse_chi_correlation_length.tikz}
  \caption{Scaling function $\mathcal{P}(t \xi(m)^{1/\nu})$ in
  \autoref{eq:order_param_scaling_relation_finite_chi_t}.}\label{fig:data_collapse_chi_correlation_length}
\end{figure}

\section{Finite-entanglement scaling and its relation to two-dimensional classical lattices}

Another way to understand the fact that the CTMRG method with finite $m$ can never accurately represent systems at
criticality, is by looking at the entanglement properties of the ground state of the corresponding one-dimensional
quantum systems.

It is known that near the critical point, when the correlation length $\xi$ is large but finite, the entanglement of a
subsystem $A$ scales as
\begin{equation}
  S_A \propto \mathcal{A}(c/6)\log(\xi)
\end{equation}
where $\mathcal{A}$ is the number of boundary points of $A$ and $c$ is the central charge of the conformal field theory
at the critical point \cite{calabrese2004entanglement, vidal2003entanglement, ercolessi2010exact}.

Recalling the definition of the entanglement entropy
\begin{equation}
  S_A = - \tr(\rho_A \log \rho_A) = - \sum_{\alpha} \omega_{\alpha} \log \omega_{\alpha},
\end{equation}
it is trivially seen that the entropy of a state given by the DMRG (or any other MPS), which only
retains $m$ basis states of $\rho_A$, is limited by
\begin{equation}
  S^{\text{max}}_A(m) = \log m
\end{equation}
by putting $\omega_{\alpha} = 1/m$ for $\alpha = 1, \dots, m$.

Thus, by assuming $S^{\text{max}}_A(m) \propto S_A$ close to criticality, one may infer that the maximum correlation length
that an MPS can capture scales as
\begin{equation}
  \xi(m) \propto m^{\kappa}.
\end{equation}

Numerical evidence of this fact was first given by the authors of \cite{andersson1999density}, who found
\begin{equation}
  \xi(m) \propto m^{1.3}
\end{equation}
for a gapless system of free fermions, using DMRG calculations. Later, using the iTEBD algorithm
\cite{vidal2007classical}, the authors of \cite{tagliacozzo2008scaling} presented numerical evidence for such a relation
for the Ising model with transverse field and the Heisenberg model, with
\begin{align}
  \kappa_{\text{Ising}} & \approx 2, \\
  \kappa_{\text{Heisenberg}} & \approx 1.37.
\end{align}

A quantitative theory of this behaviour was given in \cite{pollmann2009theory}.
Assuming the energy density as function of the effective correlation length $\xi$ takes the form
\begin{equation}
  E(\xi) = E_{\infty} + \frac{A}{\xi^2} + \frac{B}{\xi}P_r(m),
\end{equation}
where
\begin{equation}
  P_r(m) = \sum_{\alpha = m}^{\infty} \omega_{\alpha}
\end{equation}
is the residual probability.
Using results in \cite{calabrese2008entanglement} for the spectrum of $\rho_A$ in limit $m \to \infty$, $\xi$ is found
to obey
\begin{equation}
  \xi = m^{\kappa},
\end{equation}
with
\begin{equation}
  \kappa = \frac{6}{c(\sqrt{12/c} + 1)} + \mathcal{O}(1/\log m).
\end{equation}


\subsection{Numerical results}



\section{To do}

Articles to cite:

\begin{itemize}

\item \cite{tagliacozzo2008scaling}: postulates exponent $\kappa$, provides numerical support and extracts basic results
for 1D quantum systems with periodic boundary conditions. Also compares to nishino 2D results. Replicate his
experiments? Because CTM seems to give different value for $\kappa$.
\item \cite{andersson1999density}: establishes $\xi \propto m^{1.3}$ for correlation length of converged DMRG ground
states of a gapless systems of free fermions.
\item \cite{pirvu2012matrix}: assumes existence of $\kappa$ and compares finite-size scaling with finite-$m$ scaling
for 1D quantum systems with periodic boundary conditions.
\item \cite{pollmann2009theory}: proves expression for $\kappa$ in asymptotically large $m$ limit that depends only on
central charge $c$, but with corrections of order $1 / \log(\chi)$.
\item \cite{vidal2003entanglement}: Also finds $S_A \propto \log(L)$ for 1D quantum systems.
\item \cite{calabrese2004entanglement}: proves relation $S_A \propto \mathcal{A}(c/6)\log(\xi)$, with $\mathcal{A}$
the number of boundary points (verified for integrable 2d classical lattice systems).
\item \cite{ercolessi2010exact}: proves relation for classical eight vertex model
\end{itemize}

Check for validity of $\xi(m) \propto m^{\kappa}$

\begin{itemize}
  \item entropy scaling at $T_c$ (using exact value of $c$).
  \item correlation length scaling at $T_c$.
  \item data collapse of order parameter (using exact value of $T_c$, $\beta$, $\nu$.)
\end{itemize}



\section{Finding the critical point by maximizing entropy}

Articles to cite:

\begin{itemize}
  \item \cite{huang2017holographic}: theory and numerical support for directly extracting information from ctm spectrum,
  equivalence to 1D quantum systems.
  \item \cite{krvcmar2016phase}: characterisation of phase transition by ctm spectrum for $q = 6$ clock model.
  \item \cite{PhysRevE.94.022134}: characterisation of phase transition by ctm spectrum for truncated tetrahedal model.
  \item \cite{krvcmar2015reentrant}: characterisation of phase transition by ctm spectrum for Widom-Rowlinson models.
  \item \cite{osborne2002entanglement}: for XY and Ising model, proves that next-to-nearest neighbor entanglement peaks
  at critical point (though not nearest-neighbor entanglement.)


\end{itemize}
