\section{Abstract}

In this chapter, we introduce the central concepts in critical phenomena
and finite-size scaling.

We follow the excellent review by Barber \cite{barber1983finite} and
chapter five of Cardy's book \cite{cardy1996scaling}.

\section{Phase transitions}
When matter exhibits a sudden change in behaviour, often characterized by a discontinuity or divergence of one or more
thermodynamic quantities, we say it undergoes a \emph{phase transition}.

A quantity that signifies this change is called an \emph{order parameter},
which can take vastly different forms across systems and transitions.
For example, for the transition of a ferromagnet, the order parameter is the net magnetization of the system,
while for a percolation transition, it is the size of the largest connected graph.

For a historical account of the classification of phase transitions,
see \cite{jaeger1998ehrenfest}.
At the present time, we distinguish between two different types \cite{kadanoff2009more}.

When some thermodynamic quantity changes discontinuously, i.e.
shows a jump, we call the transition \emph{first order}.
In contrast, during a \emph{continuous} phase transition a variable undergoes change continuously.
The point at which a continuous phase transition occurs, is called the critical point.

The two-dimensional Ising model (\emph{ref here}) in a magnetic field shows both types of transition.
At zero magnetic field and $T = T_c = 1 / (\log(1 + \sqrt{2}))$, the magnetization changes from zero for $T > T_c$ to
a finite value for $T < T_c$ in a continuous manner.

Below the critical temperature $T_c$, when the magnetic field $h$ tends to zero from $h > 0$,
the magnetization tends to a positive value.
Conversely, when the magnetic field tends to zero from $h < 0$,
the magnetization tends to a negative value.
Thus, across the region $h = 0, T < T_c$ the system undergoes a first-order phase transition.

\subsection{Finite systems}

We will now argue that a phase transition cannot occur in a finite system,
but only happens when the number of particles tends to infinity.

Because thermodynamic quantities are averages over all possible
microstates of a system, those quantities are completely defined in terms
of the system's partition function, or equivalently its free energy.

Since in a finite system, the partition function is a finite sum of
exponentials, it is analytic (infinitely differentiable). Hence, thermodynamic
quantities cannot show true discontinuities and the phase transitions
described in the above section do not occur.

\todo[inline]{pictures?}

\section{Critical behaviour}
We will now focus our attention on continuous phase transitions, more specifically the one that occurs in the
two-dimensional Ising model.
Before we discuss the behaviour of the free energy around the critical point,
we briefly summarize how the thermodynamic limit is approached far away from it.
Here, we largely follow \cite{barber1983finite}.

We assume that the free energy per site in the thermodynamic limit
\begin{equation}
  f_{\infty}(T) = \lim_{N \to \infty} \frac{F(T, N)}{N}
\end{equation}
exists, and is not dependent on boundary conditions.
By definition, it is not analytic in a region around the critical point.

Outside that region, however, we can write
\begin{equation}\label{eq:free_energy_finite_system_outside_critical_region}
  F(T, N) = N f_{\infty}(T) + o(N),
\end{equation}
where correction terms $g(N)$ of $o(N)$ (little-o of $N$) obey
\begin{equation}
  \lim_{N \to \infty} \frac{g(N)}{N} = 0.
\end{equation}
These corrections, of course, do depend on boundary conditions.

\autoref{eq:free_energy_finite_system_outside_critical_region} is valid only outside the critical region precisely
because $F(T, N)$ is analytic \emph{everywhere}, and $f_{\infty}(T)$ is only analytic away from the critical point.

The behaviour of $F(T, N)$ (and hence, all thermodynamic quantities) at criticality is approached is described by
\emph{finite-size scaling}.

\subsection{Finite-size scaling}

\autoref{fig:order_parameter_finite_N_exact} shows the behaviour of the order parameter obtained by exact
diagonalization of the partition function of small lattices.
It is clear that far from the critical point, the order parameter is essentially not dependent on system size,
while in critical region there are significant deviations from the thermodynamic behaviour.

\begin{figure}
  \includegraphics[]{order_parameter_finite_N_exact.tikz}
  \caption{The magnetization of the central spin for small lattices with boundary spins fixed to
  $+1$. The black line is the exact solution in the thermodynamic limit.}\label{fig:order_parameter_finite_N_exact}
\end{figure}

One can now define two characteristic temperatures \cite{fisher1967interfacial,
barber1983finite}.
The first being the cross-over temperature $T_X$ at which finite-size effects become important,
which is predicted to scale as
\begin{equation}\label{eq:cross_over_temperature_scaling}
  |T_X - T_c| \propto N^{-\theta}.
\end{equation}
$\theta$ is called the cross-over or rounding exponent.

The second characteristic temperature is the pseudocritical temperature,
denoted by $T^{\star}$.
It can be defined in several ways, one being the point where the order parameter becomes almost zero,
or the point where the heat capacity
\begin{equation}
  C = T^2 \frac{\partial^2 F}{\partial T^2}
\end{equation}
reaches its maximum.
$T^{\star}$ can be regarded as the point where the finite system in some sense comes closest to undergoing a transition.

Generally $T^{\star}$ will not equal $T_X$. Furthermore, $T^{\star}$ depends on boundary conditions:
periodic or fixed boundary conditions will nudge the system into an ordered state,
therefore $T^{\star} > T_c$.
Free boundary conditions will cause the system to favor disorder and the pseudocritical temperature to be lowered.

In any case, it is predicted that
\begin{equation}
  |T^{\star} - T_c| \propto N^{-\lambda}.
\end{equation}

It is generally accepted that \cite{barber1983finite}
\begin{equation}
  \lambda = \theta.
\end{equation}

Furthermore, if one assumes that finite-size effects become important once the correlation length of the system becomes of order of the system size, i.e. \cite{fisher1967interfacial}
\begin{equation}\label{eq:correlation_length_propto_N}
  \xi(T_X(N)) \propto N,
\end{equation}
then the correlation length exponent $\nu$, given by
\begin{equation}
  \xi(T) \propto |T - T_c|^{-\nu}
\end{equation}
is, by using \autoref{eq:cross_over_temperature_scaling}, related to $\theta$ as
\begin{equation}
  \theta = \frac{1}{\nu}.
\end{equation}

\subsubsection{The finite-size scaling ansatz}

The behaviour of a system of finite size $N$ is expected to be a function of the ratio
\begin{equation}
  y = \frac{N}{\xi(T)},
\end{equation}
where $\xi(T)$ is the correlation length of the thermodynamic system \cite{fisher1972scaling}.

\todo[inline]{Footnote about systems that are not completely finite, but finite in one direction.}

With the assumption in \autoref{eq:correlation_length_propto_N}, this means that in the limit $y \gg 1$,
we expect to see thermodynamic behaviour, while for $y \ll 1$,
the finite system size should enter in the analysis.

To see exactly how this happens, consider as an example the order parameter $M$,
which in the thermodynamic limit, close to the critical point obeys
\begin{equation}
  M(T) \propto
  \begin{cases}
    (-t)^{\beta} & \text{if } T \leq T_c, \\
    0 & \text{if } T \geq T_c,
  \end{cases}
\end{equation}
where we have defined the reduced temperature
\begin{equation}
  t = \frac{T - T_c}{T_c}.
\end{equation}

Assuming the correlation length diverges algebraically
\begin{equation}\label{eq:xi_propto_t}
  \xi(T) \propto |t|^{-\nu},
\end{equation}
for $T < T_c$ we have
\begin{equation}\label{eq:order_parameter_propto_correlation_length}
  M(T) \propto \xi(T)^{-\beta / \nu}.
\end{equation}

The \emph{finite-size scaling ansatz} now says that for finite systems
\begin{equation}\label{eq:finite_size_scaling_ansatz}
  M(T, N) = N^{-\beta/\nu}\mathcal{F}(y),
\end{equation}
with the requirement that for $N \to \infty$, it should reproduce the thermodynamic behaviour
in \autoref{eq:order_parameter_propto_correlation_length}, leading to
\begin{equation}
  \lim_{y \to \infty} \mathcal{F}(y) \propto y^{\beta/\nu}.
\end{equation}
At the critical point, however, the bulk correlation length diverges and the only relevant length scale is $N$,
so that we must have
\begin{equation}
  M(T = T_c, N) \propto N^{-\beta / \nu},
\end{equation}
from which it follows that
\begin{equation}
  \lim_{y \to 0} \mathcal{F}(y) = \text{const}.
\end{equation}

\subsubsection{Extracting exponents from numerical simulation}

To extract critical exponents from (finite) numerical simulations, \autoref{eq:finite_size_scaling_ansatz} may be
written as
\begin{equation}\label{eq:finite_size_scaling_ansatz_tN}
  M(T, N) = N^{-\beta/\nu} \mathcal{G}(t N^{1/\nu})
\end{equation}
where it is used that (per \autoref{eq:xi_propto_t})
\begin{equation}
  y = \frac{N}{\xi(T)} \propto t^{\nu} N,
\end{equation}
and the new scaling function is customarily written as having argument $t N^{1/\nu} = (t^{\nu} N)^{1/\nu}$.

The critical exponents $\beta$ and $\nu$ and the critical temperature can now be extracted by asserting that the
numerical data for different system sizes should collapse on a single curve
\begin{equation}
  \mathcal{G}(t N^{1/\nu}) = M(T, N) N^{\beta/\nu}.
\end{equation}

The authors of \cite{bhattacharjee2001measure} propose a measure of the fitness $P(\beta, \nu, T_c)$ of such a data collapse
\begin{equation}
  P(\beta, \nu, T_c) = \frac{1}{\mathcal{N}_{\text{overlap}}} \sum_p \sum_{j \neq p} \sum_{i_{\text{overlap}}}
    |  M(t_{i j}, N_j) N_{j}^{\beta/\nu} - \mathcal{E}_{p}(t_{i j} N_{j}^{1/\nu} ) |,
\end{equation}
where for each system size $N_p$, the data points collected for the other system sizes $N_j$ that overlap (that is,
fall between any two data points collected for $N_p$) are compared with the interpolation $\mathcal{E}_{p}(t_{i j}
N_{j}^{1/\nu})$ between those two data points. $\mathcal{N}_{\text{overlap}}$ is the number of overlapping pairs.

It is clear that
\begin{equation}
  P(\beta, \nu, T_c) \geq 0
\end{equation}
and the optimal values for $\beta$, $\nu$ and $T_c$ minimize $P(\beta, \nu, T_c)$.

This measure for the data collapse is found, for data collected for this thesis,
to work significantly better than other proposed measures such as fitting a polynomial or order 3-8 through all data
points.

\section{Finite bond dimension scaling in the CTMRG algorithm}

Up until now, we have developed our scaling analysis in terms of a finite system size $N$.
But the approximation of the infinite-system partition function with the CTMRG algorithm depends on two parameters;
the system size $N$ and the bond dimension $m$.

A finite bond dimension $m$ carries a characteristic length scale.
Baxter \cite{baxter1978variational}, and later Ã–stlund and Rommer \cite{ostlund1995thermodynamic} (in the context of
one-dimensional quantum systems) showed that in the thermodynamic limit,
CTMRG and DMRG are variational optimizations in the space of matrix product states.
\todo[inline]{Can extend this idea a bit.}

It is known that an MPS-ansatz with finite bond dimension inherently limits the
correlation length of the system to a finite value \cite{wolf2006quantum, rommer1997class}. Hence,
thermodynamic quantities obtained from the CTMRG algorithm with finite $m$, in the limit
$N \to \infty$, cannot diverge and must show finite-size effects similar to those of some
effective finite system of size $N_{\text{eff}}(m)$ depending on the bond dimension $m$.

\autoref{fig:order_parameter_vs_T} shows the behaviour of the order parameter of the
two-dimensional Ising model for systems of finite-size,
where the result is converged in $m$, and for systems of finite $m$, where
the result is converged in the system size $N$. The results look very similar and support
the claim that there are two relevant length scales in the critical region, namely the system size $N$ and
the length scale associated to the finite bond dimension $m$.

\begin{figure}
\includegraphics[]{order_parameter_vs_T.tikz}
\caption{Upper panel: expectation value of the central spin $\langle \sigma_0 \rangle$
  after $n$ CTMRG steps. $m$ is chosen such that the truncation error is smaller than
  $10^{-6}$. Lower panel: $\langle \sigma_0 \rangle$ for systems with bond dimension $m$.}\label{fig:order_parameter_vs_T}
\end{figure}

\subsection{Definition of the effective length scale in terms of the correlation length at $T_c$}

The first direct comparison of finite-size scaling in the system size $N$ with scaling in
the bond dimension of the CTMRG method $m$ was done
in \cite{nishino1996numerical}.

In the thermodynamic limit (corresponding to infinite $m$ and $N$), we have the following
expression for the correlation length of a classical system
\cite{baxter1982exactly_correlation_length}
\begin{equation}
  \xi(T) = \frac{1}{\log\left(\frac{T_0}{T_1}\right)}.
\end{equation}
Here, $T_0$ and $T_1$ are the largest and second-largest eigenvalues of the row-to-row
transfer matrix $T$, respectively. With $N$ tending towards infinity and finite $m$, near
the critical point $\xi(T)$ should obey a scaling law of the form
\begin{equation}
  \xi(T, m) = N_{\text{eff}}(m) \mathcal{F}(N_{\text{eff}}(m) / \xi(T))
\end{equation}
with
\begin{equation}
  \mathcal{F}(x) = \begin{cases}
      \text{const} & \text{if } x \to 0, \\
      x^{-1} & \text{if } x \to \infty.
    \end{cases}
\end{equation}

Hence, the effective length scale corresponding to the finite bond dimension $m$ is
proportional to the correlation length of the system at the critical point $t = 0$.
\begin{equation}
  N_{\text{eff}}(m) \propto \xi(T = T_c, m).
\end{equation}

\todo[inline]{Look ahead to replicating this in results section?}

\subsection{Relation to finite-entropy scaling and the exponent $\kappa$.}

% Another way to understand the fact that the CTMRG method with finite $m$ can never accurately represent classical
% systems with infinite correlation length, is by looking at the entanglement properties of the ground state of
% corresponding one-dimensional quantum systems.
%
% It is known that in the critical region, the entanglement of a subsystem $A$ diverges as
% \begin{equation}\label{eq:entropy_scaling_near_criticality}
%   S_A \propto \mathcal{A}(c/6)\log(\xi)
% \end{equation}
% where $\mathcal{A}$ is the number of boundary points of $A$ and $c$ is the central charge of the conformal field theory
% at the critical point \cite{calabrese2004entanglement, vidal2003entanglement, ercolessi2010exact}.
%
% Recalling the definition of the entanglement entropy
% \begin{equation}
%   S_A = - \tr(\rho_A \log \rho_A) = - \sum_{\alpha} \omega_{\alpha} \log \omega_{\alpha},
% \end{equation}
% it is trivially seen that the entropy of a state given by the DMRG (or any other MPS), which only
% retains $m$ basis states of $\rho_A$, is limited by
% \begin{equation}
%   S^{\text{max}}_A(m) = \log m
% \end{equation}
% by putting $\omega_{\alpha} = 1/m$ for $\alpha = 1, \dots, m$.
%
% Hence, a MPS wave function can never represent a critical ground state.


The first numerical evidence of a law for the correlation length at the critical point of the form
\begin{equation}\label{eq:xi_propto_m_kappa}
  \xi(m) \propto m^{\kappa}
\end{equation}
was given by the authors of \cite{andersson1999density}, who found
\begin{equation}
  \kappa \approx 1.3
\end{equation}
for a gapless system of free fermions, using DMRG calculations. Later, using the iTEBD algorithm
\cite{vidal2007classical}, the authors of \cite{tagliacozzo2008scaling} presented numerical evidence for such a relation
for the Ising model with transverse field and the Heisenberg model, with
\begin{align}
  \kappa_{\text{Ising}} & \approx 2, \\
  \kappa_{\text{Heisenberg}} & \approx 1.37.
\end{align}

\subsubsection{Quantitative theory for $\kappa$}
A quantitative theory of the existence of an exponent $\kappa$ was given in \cite{pollmann2009theory}.
We reproduce the argument, which is presented in the language of one-dimensional quantum systems, below.

We start by noting that in the critical region, the entanglement of a half-infinite subsystem $A$ diverges as
\begin{equation}\label{eq:entropy_scaling_near_criticality}
  S_A \propto \mathcal{A}(c/6)\log(\xi),
\end{equation}
where $\mathcal{A}$ is the number of boundary points of $A$ and $c$ is the central charge of the conformal field theory
at the critical point \cite{calabrese2004entanglement, vidal2003entanglement, ercolessi2010exact}.

Recalling the definition of the entanglement entropy
\begin{equation}
  S_A = - \tr(\rho_A \log \rho_A) = - \sum_{\alpha} \omega_{\alpha} \log \omega_{\alpha},
\end{equation}
it is trivially seen that the entropy of a state given by the DMRG (or any other MPS), which only
retains $m$ basis states of $\rho_A$, is limited by
\begin{equation}
  S^{\text{max}}_A(m) = \log m
\end{equation}
by putting $\omega_{\alpha} = 1/m$ for $\alpha = 1, \dots, m$.

This is, incidentally, another way to see that DMRG or CTMRG, or any other algorithm which produces ground states with a
matrix-product structure have an inherently finite correlation length.

The leading energy correction to the free energy per site of a one-dimensional quantum system at a conformally invariant
critical point at finite temperature $T$ in the thermodynamic limit is \cite{affleck1986universal}
\begin{equation}\label{eq:correction_free_energy_critical_point_finite_temperature}
  f(T) = f_0 + aT^2 + \mathcal{O}(T^3).
\end{equation}

Due to the quantum-classical correspondence, this is equivalent to a two-dimensional classical $N \times \infty$ lattice
with strip width $N = 1/T$.
This implies also that the correlation length of a critical one-dimensional quantum system at finite temperature cannot
diverge and goes as $\xi \propto 1/T$.
In terms of this finite correlation length, \autoref{eq:correction_free_energy_critical_point_finite_temperature} is
written as
\begin{equation}\label{eq:correction_free_energy_critical_point_finite_correlation_length}
  f(\xi) = f_{\infty} + \frac{A}{\xi^2} + \mathcal{O(\frac{1}{\xi^3})}.
\end{equation}

Empirically, optimized ground states with a matrix-product structure at criticality do not simply maximize their
entropy, as they should if we take \autoref{eq:correction_free_energy_critical_point_finite_correlation_length} to be
true for ground states with a matrix-product structure.

We will now show that \autoref{eq:correction_free_energy_critical_point_finite_correlation_length} needs,
in fact, an additional term due to the matrix-product structure with finite bond dimension $m$.

The ground state with finite correlation length and energy density as in
\autoref{eq:correction_free_energy_critical_point_finite_correlation_length} has a Schmidt decomposition that in
principle can have infinitely many terms
\begin{equation}\label{eq:ground_state_infinite_schmidt_decomposition}
  \ket{\psi_0} = \sum_{n = 1}^{\infty} \lambda_n \ket{\psi_{n}^{L}}\ket{\psi_{n}^{R}},
\end{equation}
where $\ket{\psi_{n}^{L}}$ and $\ket{\psi_{n}^{R}}$ are states of the left and right infinite half-chains. Normalization
requires
\begin{equation}
  \sum_{n}^{\infty} \lambda_{n}^2 = 1.
\end{equation}

The ground state with a matrix-product structure with finite bond dimension $m$ has an additional constraint:
its Schmidt decomposition carries only the $m$ $\ket{\psi_n}$ with largest $\lambda_n$.
It is written as
\begin{equation}
  \ket{\psi_{0}^{\text{MPS}}} = \frac{\sum_{n = 1}^{m} \lambda_n
  \ket{\psi_{n}^{L}}\ket{\psi_{n}^{R}}}{\sqrt{\sum_{n=1}^{m} \lambda_{n}^2}}.
\end{equation}

To find the extra energy cost of only keeping the first $m$ terms in the Schmidt decomposition,
note that in the limit of $m$ large, $\ket{\psi_{0}^{\text{MPS}}}$ almost entirely overlaps with $\ket{\psi_0}$,
hence can be written as
\begin{equation}
  \ket{\psi_{0}^{\text{MPS}}} = \sqrt{1 - \epsilon^2} \ket{\psi_0} + \epsilon \ket{\psi_{\text{ex}}},
\end{equation}
where $\ket{\psi_{\text{ex}}}$ is some excited state and $\epsilon \ll 1$. This leads to an energy of
\begin{equation}
  E_{0}^{\text{MPS}} = \braket{\psi_{0}^{\text{MPS}} | \hat{H} | \psi_{0}^{\text{MPS}}} = E_0 + \epsilon^2 (E_{\text{ex}} - E_0),
\end{equation}
with
\begin{equation}
  \epsilon^2 = \left(1 - \braket{\psi_0 | \psi_{0}^{\text{MPS}}}^2 \right) = 1 - \sum_{n = 1}^{m} \lambda_{n}^2 \equiv
  P_{\text{res}}(m).
\end{equation}
Here, we have defined the residual probability $P_{\text{res}}$, also known as the truncation error,
as the part of the spectrum that is thrown away.

If we now assume that $E_0 - E_{\text{ex}}$ is proportional to the energy gap $\Delta$, which scales as \cite{lieb1961two, mata1989energy, pfeuty1970one}
\begin{equation}
  \Delta \propto \frac{1}{\xi},
\end{equation}
we arrive at
\begin{equation}\label{eq:correction_energy_mps_ground_state}
  E_{0}^{\text{MPS}} = E_{\infty} + \frac{A}{\xi^2} + \frac{B P_{\text{res}}(m)}{\xi}.
\end{equation}

It is clear that when the correlation length is very large, by \autoref{eq:entropy_scaling_near_criticality} the entropy
and $P_{\text{res}}(m)$ must be too.
So, the third term in \autoref{eq:correction_energy_mps_ground_state} dominates.

If the correlation length is small, the second term dominates.
The correlation length that belongs to the MPS ground state with fixed $m$ is the optimum that minimizes this
expression.

The details of the calculation, which can be found in the supplementary material of \cite{pollmann2009theory},
depend on the asymptotic form of $P_{\text{res}}$, found in \cite{calabrese2008entanglement}. In the limit $m \to \infty$, the correlation is indeed of the form in \autoref{eq:xi_propto_m_kappa} with
\begin{equation}
  \kappa = \frac{6}{c \left( \sqrt{12/c} + 1 \right) },
\end{equation}
which is in good agreement with the values found in \cite{tagliacozzo2008scaling}.

\todo[inline]{Refer back to chapter on spectrum of CTM}
