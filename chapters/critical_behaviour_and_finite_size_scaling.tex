\chapterprecishere{
In this chapter, we introduce the central concepts in critical phenomena and finite-size scaling,
largely following the review by Barber \cite{barber1983finite} and the less technical overview by Kadanoff
\cite{kadanoff2009more}.
}

\section{Phase transitions}
When matter exhibits a sudden change in behaviour, often characterized by a discontinuity or divergence of one or more
thermodynamic quantities, we say it undergoes a \emph{phase transition}.

A quantity that signifies this change is called an \emph{order parameter},
which can take vastly different forms across systems and transitions.
For example, for the transition of a ferromagnet, the order parameter is the net magnetization of the system,
while for a percolation transition, it is the size of the largest connected graph.

For a historical account of the classification of phase transitions,
see \cite{jaeger1998ehrenfest}.
At the present time, we distinguish between two different types \cite{kadanoff2009more}.

When some thermodynamic quantity changes discontinuously, i.e.
shows a jump, we call the transition \emph{first order}.
In contrast, during a \emph{continuous} phase transition a variable undergoes change continuously.
The point at which a continuous phase transition occurs, is called the critical point.

The two-dimensional Ising model (\emph{ref here}) in a magnetic field shows both types of transition.
At zero magnetic field and $T = T_c = 1 / (\log(1 + \sqrt{2}))$, the magnetization changes from zero for $T > T_c$ to
a finite value for $T < T_c$ in a continuous manner.

Below the critical temperature $T_c$, when the magnetic field $h$ tends to zero from $h > 0$,
the magnetization tends to a positive value.
Conversely, when the magnetic field tends to zero from $h < 0$,
the magnetization tends to a negative value.
Thus, across the region $h = 0, T < T_c$ the system undergoes a first-order phase transition.

\subsection{Finite systems}

We will now argue that a phase transition cannot occur in a finite system,
but only happens when the number of particles tends to infinity.

Because thermodynamic quantities are averages over all possible
microstates of a system, those quantities are completely defined in terms
of the system's partition function, or equivalently its free energy.

Since in a finite system, the partition function is a finite sum of
exponentials, it is analytic (infinitely differentiable). Hence, thermodynamic
quantities cannot show true discontinuities and the phase transitions
described in the above section do not occur.

\todo[inline]{pictures?}

\section{Critical behaviour}
We will now focus our attention on continuous phase transitions, more specifically the one that occurs in the
two-dimensional Ising model.
Before we discuss the behaviour of the free energy around the critical point,
we briefly summarize how the thermodynamic limit is approached far away from it.
Here, we largely follow \cite{barber1983finite}.

We assume that the free energy per site in the thermodynamic limit
\begin{equation}
  f_{\infty}(T) = \lim_{N \to \infty} \frac{F(T, N)}{N}
\end{equation}
exists, and is not dependent on boundary conditions.
By definition, it is not analytic in a region around the critical point.

Outside that region, however, we can write
\begin{equation}\label{eq:free_energy_finite_system_outside_critical_region}
  F(T, N) = N f_{\infty}(T) + o(N),
\end{equation}
where correction terms $g(N)$ of $o(N)$ (little-o of $N$) obey
\begin{equation}
  \lim_{N \to \infty} \frac{g(N)}{N} = 0.
\end{equation}
These corrections, of course, do depend on boundary conditions.

\autoref{eq:free_energy_finite_system_outside_critical_region} is valid only outside the critical region precisely
because $F(T, N)$ is analytic \emph{everywhere}, and $f_{\infty}(T)$ is only analytic away from the critical point.

The behaviour of $F(T, N)$ (and hence, all thermodynamic quantities) at criticality is approached is described by
\emph{finite-size scaling}.

\subsection{Finite-size scaling}

\autoref{fig:order_parameter_finite_N_exact} shows the behaviour of the order parameter obtained by exact
diagonalization of the partition function of small lattices.
It is clear that far from the critical point, the order parameter is essentially not dependent on system size,
while in critical region there are significant deviations from the thermodynamic behaviour.

\begin{figure}
  \includegraphics[]{order_parameter_finite_N_exact.tikz}
  \caption{The magnetization of the central spin for small lattices with boundary spins fixed to
  $+1$. The black line is the exact solution in the thermodynamic limit.}\label{fig:order_parameter_finite_N_exact}
\end{figure}

One can now define two characteristic temperatures \cite{fisher1967interfacial,
barber1983finite}.
The first being the cross-over temperature $T_X$ at which finite-size effects become important,
which is predicted to scale as
\begin{equation}\label{eq:cross_over_temperature_scaling}
  |T_X - T_c| \propto N^{-\theta}.
\end{equation}
$\theta$ is called the cross-over or rounding exponent.

The second characteristic temperature is the pseudocritical temperature,
denoted by $T^{\star}$.
It can be defined in several ways, one being the point where the order parameter becomes almost zero,
or the point where the heat capacity
\begin{equation}
  C = T^2 \frac{\partial^2 F}{\partial T^2}
\end{equation}
reaches its maximum.
$T^{\star}$ can be regarded as the point where the finite system in some sense comes closest to undergoing a transition.

Generally $T^{\star}$ will not equal $T_X$. Furthermore, $T^{\star}$ depends on boundary conditions:
periodic or fixed boundary conditions will nudge the system into an ordered state,
therefore $T^{\star} > T_c$.
Free boundary conditions will cause the system to favor disorder and the pseudocritical temperature to be lowered.

In any case, it is predicted that
\begin{equation}\label{eq:scaling_law_T_star}
  |T^{\star} - T_c| \propto N^{-\lambda}.
\end{equation}

It is generally accepted that \cite{barber1983finite}
\begin{equation}
  \lambda = \theta.
\end{equation}

Furthermore, if one assumes that finite-size effects become important once the correlation length of the system becomes of order of the system size, i.e. \cite{fisher1967interfacial}
\begin{equation}\label{eq:correlation_length_propto_N}
  \xi(T_X(N)) \propto N,
\end{equation}
then the correlation length exponent $\nu$, given by
\begin{equation}
  \xi(T) \propto |T - T_c|^{-\nu}
\end{equation}
is, by using \autoref{eq:cross_over_temperature_scaling}, related to $\theta$ as
\begin{equation}
  \theta = \frac{1}{\nu}.
\end{equation}

\subsubsection{The finite-size scaling ansatz}

The behaviour of a system of finite size $N$ is expected to be a function of the ratio
\begin{equation}
  y = \frac{N}{\xi(T)},
\end{equation}
where $\xi(T)$ is the correlation length of the thermodynamic system \cite{fisher1972scaling}.

\todo[inline]{Footnote about systems that are not completely finite, but finite in one direction.}

With the assumption in \autoref{eq:correlation_length_propto_N}, this means that in the limit $y \gg 1$,
we expect to see thermodynamic behaviour, while for $y \ll 1$,
the finite system size should enter in the analysis.

To see exactly how this happens, consider as an example the order parameter $M$,
which in the thermodynamic limit, close to the critical point obeys
\begin{equation}
  M(T) \propto
  \begin{cases}
    (-t)^{\beta} & \text{if } T \leq T_c, \\
    0 & \text{if } T \geq T_c,
  \end{cases}
\end{equation}
where we have defined the reduced temperature
\begin{equation}
  t = \frac{T - T_c}{T_c}.
\end{equation}

Assuming the correlation length diverges algebraically
\begin{equation}\label{eq:xi_propto_t}
  \xi(T) \propto |t|^{-\nu},
\end{equation}
for $T < T_c$ we have
\begin{equation}\label{eq:order_parameter_propto_correlation_length}
  M(T) \propto \xi(T)^{-\beta / \nu}.
\end{equation}

The \emph{finite-size scaling ansatz} now says that for finite systems
\begin{equation}\label{eq:finite_size_scaling_ansatz}
  M(T, N) = N^{-\beta/\nu}\mathcal{F}(y),
\end{equation}
with the requirement that for $N \to \infty$, it should reproduce the thermodynamic behaviour
in \autoref{eq:order_parameter_propto_correlation_length}, leading to
\begin{equation}
  \lim_{y \to \infty} \mathcal{F}(y) \propto y^{\beta/\nu}.
\end{equation}
At the critical point, however, the bulk correlation length diverges and the only relevant length scale is $N$,
so that we must have
\begin{equation}
  M(T = T_c, N) \propto N^{-\beta / \nu},
\end{equation}
from which it follows that
\begin{equation}
  \lim_{y \to 0} \mathcal{F}(y) = \text{const}.
\end{equation}

\subsubsection{Extracting exponents from numerical simulation}\label{sec:extracting_exponents_from_numerical_simulation}

To extract critical exponents from (finite) numerical simulations, \autoref{eq:finite_size_scaling_ansatz} may be
written as
\begin{equation}\label{eq:finite_size_scaling_ansatz_tN}
  M(T, N) = N^{-\beta/\nu} \mathcal{G}(t N^{1/\nu})
\end{equation}
where it is used that (per \autoref{eq:xi_propto_t})
\begin{equation}
  y = \frac{N}{\xi(T)} \propto t^{\nu} N,
\end{equation}
and the new scaling function is customarily written as having argument $t N^{1/\nu} = (t^{\nu} N)^{1/\nu}$.

The critical exponents $\beta$ and $\nu$ and the critical temperature can now be extracted by asserting that the
numerical data for different system sizes should collapse on a single curve
\begin{equation}
  \mathcal{G}(t N^{1/\nu}) = M(T, N) N^{\beta/\nu}.
\end{equation}

The authors of \cite{bhattacharjee2001measure} propose a measure of the fitness $P(\beta, \nu, T_c)$ of such a data collapse
\begin{equation}\label{eq:fitness_data_collapse}
  P(\beta, \nu, T_c) = \frac{1}{\mathcal{N}_{\text{overlap}}} \sum_p \sum_{j \neq p} \sum_{i_{\text{overlap}}}
    |  M(t_{i j}, N_j) N_{j}^{\beta/\nu} - \mathcal{E}_{p}(t_{i j} N_{j}^{1/\nu} ) |,
\end{equation}
where for each system size $N_p$, the data points collected for the other system sizes $N_j$ that overlap (that is,
fall between any two data points collected for $N_p$) are compared with the interpolation $\mathcal{E}_{p}(t_{i j}
N_{j}^{1/\nu})$ between those two data points. $\mathcal{N}_{\text{overlap}}$ is the number of overlapping pairs.

It is clear that
\begin{equation}
  P(\beta, \nu, T_c) \geq 0
\end{equation}
and the optimal values for $\beta$, $\nu$ and $T_c$ minimize $P(\beta, \nu, T_c)$.

This measure for the data collapse is found, for data collected for this thesis,
to work significantly better than other proposed measures such as fitting a polynomial or order 3-8 through all data
points.
