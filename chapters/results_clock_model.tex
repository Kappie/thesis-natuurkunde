\begin{abstract}
\noindent We present a numerical study of the square-lattice clock model with $q = \{5, 6\}$ states.
We employ the corner transfer matrix renormalization group method,
working in both finite-size and finite-$m$ regimes.

The model has a low-temperature ordered phase, a massless phase and a high-temperature disordered phase.
We locate the transition temperatures $T_1$ and $T_2$ by extrapolating the positions of pseudocritical temperatures,
assuming the transitions are of the Kosterlitz-Thouless type.

The pseudocritical temperature is defined as the point where the classical analogue of the entanglement entropy reaches
its maxixum. For free (fixed) boundary conditions the entropy peaks near $T_1$ ($T_2$).

In addition, we calculate the central charge and the magnetization exponent in the massless phase.
In comparison with exact results for the Villain formulation, the magnetization exponent suggests that the locations of
$T_1$ and $T_2$ found in this work might underestimate the extent of the massless phase,
but we argue it is plausible that this is due to finite-size effects.
\end{abstract}

\section{Introduction}
In the field of phase transitions and critical phenomena, the two-dimensional topological phase transition discovered by
Kosterlitz and Thouless \cite{kosterlitz1973ordering, kosterlitz1974critical} receives much attention. This phase
transition is characterized not by an order parameter which indicates a breaking of symmetry, but by the proliferation
of topological defects.

In the low-temperature phase, the two-point correlation functions decay with a power-law with varying
exponent $\eta(T)$. At the transition, the correlation length diverges as
\begin{equation}\label{eq:corr_length_divergence_kt}
  \xi \propto \exp(A |T - T_c|^{-1/2}),
\end{equation}
with $A$ a non-universal constant. Above the transition, the two-point correlators decay exponentially.

The XY model consists of planar rotors on the square lattice. It exhibits the Kosterlitz-Thouless (KT) phase transition
and by the Mermin-Wagner-Hohenberg theorem the symmetry of the ground state is broken for all temperatures, due to
the $O(2)$ (planar rotational) symmetry of the potential \cite{mermin1966absence, hohenberg1967existence}.

The $q$-state clock model possesses the discrete $\mathbb{Z}_q$ symmetry and is an interpolation between the Ising
model, which corresponds to $q = 2$, and the XY model, which corresponds to $q \to \infty$. Its energy function is given
by
\begin{equation}\label{eq:hamiltonian_clock_model}
  H_q = -\sum_{\langle i j \rangle} \cos(\theta_i - \theta_j),
\end{equation}
with the spins taking the values
\begin{equation}
  \theta = \frac{2 \pi n}{q} \qquad n \in \{ 0, \dots, q-1 \}.
\end{equation}

It has been proven that for high enough $q$, this model indeed exhibits a Kosterlitz-Thouless transition
\cite{frohlich1981kosterlitz}. Furthermore, it has been proven that for $q \geq 5$, a general model with $\mathbb{Z}_q$
symmetry (of which \autoref{eq:hamiltonian_clock_model} is a special case) has three phases: a symmetry broken phase for
$T < T_1$, an intermediate phase with power law decay of the correlation function, and a high-temperature phase with
exponential decay of the correlation function for $T > T_2$ \cite{cardy1980general}.

In the Villain formulation of the potential \cite{villain1975theory}, it has been proven that the transition at $T_2$ is
a BK-transition \cite{jose1977renormalization}, and numerical results suggest that for a broad range of temperatures,
the thermodynamic behaviour becomes identical to the XY model for high enough $q$ \cite{lapilli2006universality}.

Furthermore, in the Villain formulation it is known that \cite{elitzur1979phase, nienhuis1984critical}
\begin{equation}\label{eq:eta_villain}
  \eta(T_1) =\frac{4}{q^2}, \qquad \eta(T_2) = \frac{1}{4},
\end{equation}
where $\eta$ is the spin-spin correlation function exponent.
In CTMRG simulations, it is possible to obtain this exponent through the relation
\begin{equation}
  \frac{\eta}{2} = \frac{\beta}{\nu},
\end{equation}
where the fraction $\frac{\beta}{\nu}$ is found by finite-size scaling of the magnetization (see
\autoref{sec:finite_size_scaling}).

For the cosine model in \autoref{eq:hamiltonian_clock_model}, the value $q_c$ for which it first exhibits a
BK-transition is not precisely known.
There is some disagreement about whether the cases $q = 5, 6$ exhibit KT-type transitions (see previous numerical
results below).

In our simulations we will focus on the cases $q = 5, 6$, to (i) study the nature of the phase transition from the new
perspective provided by the corner transfer matrix formalism and (ii) compare the accuracy of finite-$m$ and finite-$N$
scaling within the CTMRG method to other established numerical methods.

We summarise previous numerical results, then present results obtained with the CTMRG algorithm and finish with a
discussion.

\section{Previous numerical results}
\subsection{The $q = 5$ clock model}

The general consensus is that the two transitions of the $q = 5$ clock model with cosine potential are of the KT-type,
though there are no rigorous results.
It is also assumed that the critical indices are the same as those in the Villain formulation.

The disagreement about the nature of the phase transitions
stems from numerical results for the helicity modulus
\cite{fisher1973helicity}.

Most notably, Baek and Minnhagen \cite{baek2010non} claim that since the helicity modulus does
not vanish in the high-temperature phase, the upper transition is not of the KT-type.

It was shown by Kumano et al.
in \cite{kumano2013response}, however, that the definition used by Baek and Minnhagen is not suitable for systems with a
discrete symmetry.
The correct discrete definition yields the expected result, namely that the helicity modulus does vanish and the
three-phase KT-picture holds.

The conclusion of Kumano et al, which was obtained by a Monte Carlo study,
was verified by Chatelain \cite{chatelain2014dmrg} using the TMRG algorithm \cite{nishino1995density} (see also
\autoref{sec:tmrg}).
Chatelain also found that the critical indices match those of the Villain model (\autoref{eq:eta_villain}),
implying the cosine model is in the same universality class.

After the rebuttal by Kumano et al., Baek et al.
published another work \cite{baek2013residual} in which they again use the (in the eyes of Kumano et al.) wrong
definition of the helicity modulus, yet calculated in a different way.
Again they conclude the transition is not of the KT-type.

Meanwhile, Borisenko et al.
\cite{borisenko2011numerical} carried out a very detailed Monte Carlo study confirming the KT-picture,
using Binder-cumulants to find the critical points and the magnetization and susceptability to find the critical
indices.

Brito et al.
\cite{brito2010twodimensional} conclude from a Monte Carlo study that while the transition is of KT-type,
the resolution of their numerical method is not high enough to distinguish between $T_1$ and $T_2$.

\autoref{table:q5_previous_results} shows the results for the transition temperatures found by other authors.

\subsection{The $q = 6$ clock model}

Here, there is overwhelming consensus that both transitions are of the KT-type.
The only exceptions are Lapilli et al. \cite{lapilli2006universality} and Hwang \cite{hwang2009six}.

Lapilli et al. use the incorrect definition of the helicity modulus.

Hwang asserts that the transition is not of KT-type because the data,
which was obtained from systems of rather small size ($L \times L$-systems with $L = 20,
\dots, 28$), also agrees with a power-law divergence of the correlation length.

The previous results for the transition temperatures are listed in \autoref{table:q6_previous_results}.
For an overview that goes further back, see \cite{krvcmar2016phase}.

We note that \cite{tomita2002probability, brito2010twodimensional, kumano2013response} use Monte Carlo methods,
while \cite{krvcmar2016phase} uses the CTMRG algorithm (combined with finite-size scaling,
but not with finite-$m$ scaling).

\begin{table}[]
\centering
\begin{tabular}{@{}lll@{}}
\toprule
 & $T_1$ & $T_2$ \\ \midrule
Brito et al.\tablefootnote{These authors found $T_1 > T_2$, which is not an error in the text, but due to the low resolution of the methods used.} (2010) \cite{brito2010twodimensional} & 0.91 & 0.90 \\
Borisenko et al. (2011) \cite{borisenko2011numerical} & 0.9056 & 0.9432 \\
Kumano et al. (2013) \cite{kumano2013response} & 0.908  & 0.944  \\
Chatelain (2014) \cite{chatelain2014dmrg} & 0.914 & 0.945  \\ \midrule
This work (finite-$N$ scaling) & 0.915 & 0.935 \\
This work (finite-$m$ scaling) & - & 0.944 \\ \bottomrule
\end{tabular}
\caption{Previous results for the transition temperatures for $q = 5$.}
\label{table:q5_previous_results}
\end{table}

\begin{table}[]
\centering
\begin{tabular}{@{}lll@{}}
\toprule
 & $T_1$ & $T_2$ \\ \midrule
Tomita and Okabe (2002) \cite{tomita2002probability} & 0.7014 & 0.9008 \\
Hwang\tablefootnote{To obtain these values, the author assumed an algebraic divergence of the correlation length.} (2009) \cite{hwang2009six} & 0.632 & 0.997 \\
Brito et al. (2010) \cite{brito2010twodimensional} & 0.68 & 0.90 \\
Kumano et al. (2013) \cite{kumano2013response} & 0.700 & 0.904 \\
Krčmár et al. (2016) \cite{krvcmar2016phase} & 0.70 & 0.88 \\ \midrule
This work (finite-$N$ scaling) & 0.700 & 0.883 \\
This work (finite-$m$ scaling) & - & 0.901 \\ \bottomrule
\end{tabular}
\caption{Previous results for the transition temperatures for $q = 6$.}
\label{table:q6_previous_results}
\end{table}

\section{Spectrum of the corner transfer matrix}

In order to get an idea of the accuracy that we might expect, we have plotted the spectrum of the $q = \{5,
6\}$ clock models in \autoref{fig:spectrum_ctm_clock}.

It is clear that the spectra of both clock models fall off at about the same pace,
if we compare points in the ordered, massless and disordered phase.
The $q = 6$ clock model has a slightly more degenerate spectrum, as might be expected from its larger symmetry group,
but there is no clear pattern.

As compared to the Ising model (see \autoref{sec:spectrum_of_ctm}), the spectra of the $q = \{5,
6\}$ clock models fall off much more slowly\footnote{For the calculation of the spectrum of the Ising model in this
work, a bond dimension of $m = 250$ was used, as opposed to $m = 100$ for the clock model.
This means that, in small part, the slower decay of the spectrum is due to the normalization $\tr A^4 = 1$.
But this does not change the general picture that the spectra of the $q = \{5,
6\}$ clock models decay more slowly.}.
This implies that a much larger bond dimension is needed to obtain the same accuracy for quantities in the thermodynamic
limit.

\begin{figure}
  \includegraphics[]{spectrum_ctm_clock.tikz}
  \caption{First part of the spectrum of $A$ with fixed boundary,
  calculated with $m = 100$ and a convergence threshold of $10^{-8}$,
  at temperatures corresponding to the ordered phase, approximate midpoint of the massless phase and disordered phase,
  respectively.}\label{fig:spectrum_ctm_clock}
\end{figure}

\section{Magnetization}

For the clock model, we define the magnetization per site as
\begin{equation}\label{eq:magnetization_clock_model}
  M = \langle \cos \theta_0 \rangle,
\end{equation}
where $\theta_0$ is the central spin.

This quantity can be computed in the same way as for the Ising model (see \autoref{sec:magnetization_per_site}) by
generalizing the tensor $b_{i j k l}$ to
\begin{equation}
  b_{i j k l} = \sum_{n \in \{ 0, \dots, q-1 \}} \cos \left( \frac{2\pi n}{q} \right) \delta_{n i j k l}.
\end{equation}

\section{Classical analogue to the entanglement entropy}

The classical analogue to the half-chain entanglement entropy $S$ is defined in \autoref{sec:analogy_to_entropy}.
Its definition remains valid.

In the limit $T \to \infty$, for both a fixed and free boundary, we have
\begin{equation}
  S(T \to \infty) = 0.
\end{equation}

To see this, consider that all $2^{2N}$ configurations on the inner edges of the $N \times N$ quadrant represented by
the corner transfer matrix are equally likely in this limit, hence
\begin{equation}
  A_{i j} = \frac{1}{2^{2N}},
\end{equation}
which has one eigenvalue of 1 and the others 0\footnote{One can also make the argument that the corresponding
quantum state tends to a product state in the limit $T \to 0$,
yielding the same conclusion.}.

In the limit $T \to 0$, there is only one non-zero matrix element in the case of a fixed boundary (namely all inner
spins having the same value as the outer boundary), and $q$ equally likely configurations in the case of a free
boundary, yielding
\begin{align*}
  S^{\text{fixed}}(T = 0) &= 0, \\
  S^{\text{free}}(T = 0)  &= \log q.
\end{align*}

For a fixed boundary, the point of maximum entropy approaches the massless phase from the high-temperature region,
hence tending towards $T_2$.
In contrast, the point of maximum entropy approaches $T_1$ for systems with a free boundary.

\autoref{figure:entropy_and_order_param_vs_T_clock5} and \autoref{figure:entropy_and_order_param_vs_T_clock6} show
these quantities for $q = 5$ and $q = 6$ for systems with a fixed boundary, clearly confirming the three-phase picture.

\begin{figure}
  \includegraphics[]{entropy_and_order_param_vs_T_clock5.tikz}
  \caption{Classical analogue to half chain entanglement entropy (\autoref{sec:analogy_to_entropy}) and magnetization
  (\autoref{eq:magnetization_clock_model}) computed for systems with a fixed boundary for the $q = 5$ clock model.
  Simulations were done with a convergence threshold of $10^{-7}$. The dashed lines denote the transition temperatures found in this study.}\label{figure:entropy_and_order_param_vs_T_clock5}
\end{figure}

\begin{figure}
  \includegraphics[]{entropy_and_order_param_vs_T_clock6.tikz}
  \caption{Classical analogue to half chain entanglement entropy (\autoref{sec:analogy_to_entropy}) and magnetization
  (\autoref{eq:magnetization_clock_model}) computed for systems with a fixed boundary for the $q = 6$ clock model.
  Simulations were done with a convergence threshold of $10^{-7}$. The dashed lines denote the transition temperatures found in this study.}\label{figure:entropy_and_order_param_vs_T_clock6}
\end{figure}

\section{Transition temperatures}

Since we expect an essential singularity of the form in \autoref{eq:corr_length_divergence_kt} for both transitions,
for finite systems we have
\begin{equation}\label{eq:kt_t_pseudocrit}
  N = a \exp \left( b |T^{\star}(N) - T_c|^{-1/2}  \right),
\end{equation}
where $N$ is an effective finite length scale of the system and $a$ and $b$ are non-universal constants.

$N$ is the system size in the case of finite-size scaling and a length scale derived $\xi(m)$ from the bond dimension
$m$ in the case of finite-$m$ scaling.
Throughout this chapter, we have defined $\xi(m)$ through the relation
\begin{equation}\label{eq:entropy_as_function_of_xi2}
  S \propto \frac{c}{6} \log \xi(m)
\end{equation}
where $c = 1$ is expected, since the massless phase corresponds to a Gaussian model \cite{kosterlitz1974critical}.
These assumptions are validated in \autoref{sec:central_charge_massless_phase}.

We define $T^{\star}(N)$ as the point of maximum entanglement entropy, as discussed in
\autoref{sec:locating_critical_point_entanglement}.

Inverting \autoref{eq:kt_t_pseudocrit} gives the following relations for the pseudocritical transition temperatures
\begin{align}
  T^{\star}_{1}(N) &= -\frac{\alpha_1}{(\log \beta_1 N)^2} + T_1 \\
  T^{\star}_{2}(N) &= \frac{\alpha_2}{(\log \beta_2 N)^2} + T_2
\end{align}
where $\alpha = b^2$ and $\beta = 1/a$ (we drop the subscripts denoting the transition).

For convenience, we define the scaled length variable
\begin{equation}\label{eq:scaled_length_scale_kt}
  \ell = (\log \beta N)^2,
\end{equation}
such that
\begin{equation}
  T^{\star}(N) - T_c \propto \frac{1}{\ell}.
\end{equation}

\subsection{Numerical difficulties with finite-$m$ simulations around $T_1$}\label{sec:numerical_difficulties_t1}

For both the $q = \{5, 6\}$ clock models, it has been found that locating $T_1^{\star}(m)$ is not possible,
since for systems with a free boundary, numerical errors cause the matrices $A$ and $P$ to lose their symmetry and
converge to a fixed boundary fixed point instead.
This happens after a modest amount of steps, especially near $T_1(m)^{\star}$,
making it impossible to reach any feasible convergence threshold such as $10^{-6}$.

This means that for locating $T_1$, we must rely on finite-size scaling,
whereas for locating $T_2$ we can rely on both finite-size and finite-$m$ scaling.

\subsection{Transition from the ordered to the massless phase $T_1$}

\autoref{figure:t1_fit_q5} and \autoref{figure:t1_fit_q6} show the fits to \autoref{eq:kt_t_pseudocrit} for $q = \{ 5,
6\}$, yielding
\begin{equation}
  T_1^{q = 5} = 0.915, \qquad T_1^{q = 6} = 0.700.
\end{equation}

Conform to the Kosterlitz-Thouless divergence of the correlation length,
the pseudocritical temperatures indeed become linear in $\frac{1}{\ell}$,
with $\ell$ defined in \autoref{eq:scaled_length_scale_kt}.

It is interesting to note that finite-size effects are much more pronounced for $q = 5$.

\begin{figure}
  \centering
  \includegraphics[]{t1_fit_q5.tikz}
  \caption{We find $T_1 = 0.915$ for the $q = 5$ clock model.
  We have fitted the final 8 points $n = \{ 60, 65, 70, 80, 90,
  100, 110, 120 \}$. Not included in the fit are $n = \{ 10, 15, \dots, 55 \}$.
  $m$ was chosen such that the truncation error was smaller than $10^{-6}$ for $n \leq 70$ and smaller than $10^{-5}$
  for $n > 70$.
  In finding the maximum of the entropy, a tolerance in temperature of $10^{-5}$ was used.
  }\label{figure:t1_fit_q5}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[]{t1_fit_q6.tikz}
  \caption{We find $T_1 = 0.700$ for the $q = 6$ clock model.
  We have fitted the final 8 points $n = \{ 35, 40, 45, 50, 55,
  60, 70, 80 \}$.
  Not included in the fit are $n = \{ 15, 20, 25, 30 \}$.
  $m$ was chosen such that the truncation error was smaller than $10^{-6}$ for $n \leq 60$ and smaller than $10^{-5}$
  for $n > 60$.
  In finding the maximum of the entropy, a tolerance in temperature of $10^{-5}$ was used.
  }\label{figure:t1_fit_q6}
\end{figure}

\subsection{Transition from the massless to the disordered phase $T_2$}

\subsubsection{Finite-size scaling}
Finite-size scaling, shown in \autoref{figure:t2_fit_q5_finite_N} for $q = 5$ and \autoref{figure:t2_fit_q6_finite_N}
for $q = 6$ yields
\begin{equation}
  T_2^{q = 5} = 0.935, \qquad T_2^{q = 6} = 0.883.
\end{equation}

For both clock models, finite-size effects are large. For $q = 6$, the finite-size effects are more pronounced
than at $T_1$.

\subsubsection{Finite-$m$ scaling}
Finite-$m$ scaling, shown in \autoref{figure:t2_fit_q5_finite_m} for $q = 5$ and \autoref{figure:t2_fit_q6_finite_m}
for $q = 6$ yields
\begin{equation}
  T_2^{q = 5} = 0.944, \qquad T_2^{q = 6} = 0.901.
\end{equation}

It is seen that with finite-$m$ simulations,
systems of significantly larger effective size can be simulated.
From the finite-size fits to $T_2^{\star}(N)$, it can be estimated that a system of $m = 90$ approximately corresponds
to a $2700 \times 2700$ lattice for $q = 5$ and a $2400 \times 2400$ lattice for $q = 6$.

There is some structure in the data, but as long as a wide range of $m$ values is included,
the estimation of $T_2$ is robust.

\begin{figure}
  \centering
  \includegraphics[]{t2_fit_q5_finite_N.tikz}
  \caption{We find $T_2 = 0.935$ for the $q = 5$ clock model with finite-size scaling.
  We have fitted the final 6 points $n = \{ 85, 90, \dots, 110 \}$.
  $m$ was chosen such that the truncation error was smaller than $10^{-6}$.
  In finding the maximum of the entropy, a tolerance in temperature of $10^{-6}$ was used.}
  \label{figure:t2_fit_q5_finite_N}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[]{t2_fit_q5_finite_m.tikz}
  \caption{
  For the finite-$m$ simulations, the fit yields $T_2 = 0.944$.
  using $m = 20, 25, \dots,
  90$ with a convergence threshold of $10^{-7}$.
  The pseudocritical temperature belonging to $m = 10$ is also shown,
  but is not included in the fit.}\label{figure:t2_fit_q5_finite_m}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[]{t2_fit_q6_finite_N.tikz}
  \caption{We find $T_2 = 0.883$ for the $q = 6$ clock model with finite-size scaling.
  We have fitted the final 6 points $n = \{ 60, 65, \dots, 85 \}$.
  The points $n = \{ 10, 15, \dots, 55 \}$ were not included.
  $m$ was chosen such that the truncation error was smaller than $10^{-6}$.
  In finding the maximum of the entropy, a tolerance in temperature of $10^{-6}$ was used.}
  \label{figure:t2_fit_q6_finite_N}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[]{t2_fit_q6_finite_m.tikz}
  \caption{
  For the finite-$m$ simulations, the fit yields $T_2 = 0.901$.
  using $m = 20, 25, \dots,
  90$ with a convergence threshold of $10^{-7}$.
  The pseudocritical temperature belonging to $m = 10$ is also shown,
  but is not included in the fit.}\label{figure:t2_fit_q6_finite_m}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[]{t2_fit_q5_finite_m.tikz}
  \caption{
  For the finite-$m$ simulations, the fit yields $T_2 = 0.944$.
  using $m = 20, 25, \dots,
  90$ with a convergence threshold of $10^{-7}$.
  The pseudocritical temperature belonging to $m = 10$ is also shown,
  but is not included in the fit.}\label{figure:t2_fit_q5_finite_m}
\end{figure}

\section{The massless phase}

\subsection{Central charge}\label{sec:central_charge_massless_phase}

By fitting the relation in \autoref{eq:entropy_as_function_of_xi2},
where $\xi(m)$ is calculated as in \autoref{sec:definition_effective_length_scale_in_terms_of_xi},
we can directly extract the central charge of the massless phase.

For $q = \{5, 6\}$ the results are shown in the top panels of \autoref{figure:c_and_magnetic_exponent_vs_T} and
\autoref{figure:c_and_magnetic_exponent_vs_T_q6}.
For both models, we recover $c = 1$.

For $q = 5$, the positions of $T_1$ and $T_2$ do not precisely agree with the region in which a good fit to
\autoref{eq:entropy_as_function_of_xi2} can be obtained.
The actual massless phase seems to be larger than what the critical temperatures indicate.

However, it is not clear how an effective value of $c$ diverges from 1 outside the massless phase,
so we do not draw any conclusions about the correctness of $T_1$ and $T_2$ for $q = 5$ based on these results.

\subsection{Varying exponent for the magnetization}
We may verify the exponent with which the magnetization goes to zero in the massless phase by fitting
\begin{equation}\label{eq:magnetization_scaling_massless_phase}
  M(m, T) = \xi(m)^{-\frac{\eta(T)}{2}},
\end{equation}
with $\xi(m)$ again defined via \autoref{eq:entropy_as_function_of_xi2}.

The result is shown in the middle panels of \autoref{figure:c_and_magnetic_exponent_vs_T} and
\autoref{figure:c_and_magnetic_exponent_vs_T_q6} for $q = \{5, 6\}$,
respectively.

If we assume that the model under study is in the same universality class as the Villain formulation,
$\eta$ should take the values listed in \autoref{eq:eta_villain} at the critical points.
Again, the positions of the critical points found in this work seem to be too close together,
except for the lower transition of $q = 6$, which agrees well with the theoretical value.

Since the lower transition for $q = 6$ suffers the least from finite-size effects,
it is plausible that the disagreement between the other transitions and the value of $\eta$ will be resolved when larger
systems are considered, or finite-size effects are properly taken into account.
We come back to this point in the discussion.

The lower panels of \autoref{figure:c_and_magnetic_exponent_vs_T} and \autoref{figure:c_and_magnetic_exponent_vs_T_q6}
show the norm of residuals of the fit to \autoref{eq:magnetization_scaling_massless_phase}.
For $q = 6$, there were values of the magnetization for $0.7 < T < 0.83$ that were lower than expected
for certain values of $m$, reflected by the higher norm of residuals in this region.
This did not significantly influence the values of $c$ and $\eta$ found.

\begin{figure}
  \centering
  \includegraphics[]{c_and_magnetic_exponent_vs_T.tikz}
  \caption{Top panel: central charge obtained from fit to \autoref{eq:entropy_as_function_of_xi2}. The horizontal dashed line marks $c = 1$.
  Middle panel: $\eta = 2 \beta / \nu$ obtained from fit to \autoref{eq:magnetization_scaling_massless_phase}.
  First 4 values were left out of the fit.
  The horizontal dashed lines mark $\eta = 4/25$ and $\eta = 1/4$, the exact values obtained in the Villain formulation.
  Bottom panel: norm of residuals for the fit to \autoref{eq:magnetization_scaling_massless_phase}.
  For all calculations, we have used $m = 10, 20, \dots, 100$, simulated with a convergence threshold of $5 \times
  10^{-8}$. The first four values of $m$ were left out of the fits to mitigate finite-size effects.
  The vertical dashed lines mark the values of the critical points found in this work,
  where both results of $T_2$ are included.
}\label{figure:c_and_magnetic_exponent_vs_T}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[]{c_and_magnetic_exponent_vs_T_q6.tikz}
  \caption{Same as \autoref{figure:c_and_magnetic_exponent_vs_T}, except that in the middle panel,
  the horizontal lines mark $\eta = 4/36$ and $\eta = 1/4$.
  Finite-size effects were less prominent, but there were some anomalous simulations for $0.7 < T < 0.83$ that showed
  lower magnetization than expected for certain $m$-values.
  We have found that including every $m$-value in the fit gave the best results.
}\label{figure:c_and_magnetic_exponent_vs_T_q6}
\end{figure}

% \begin{figure}
%   \centering
%   \includegraphics[]{fits_magnetization_massless_phase.tikz}
%   \caption{Fits to \autoref{eq:magnetization_scaling_massless_phase} for temperatures a little bit to the left of,
%   in the middle of and a little bit to the right of the massless phase,
%   respectively.
% }\label{figure:fits_magnetization_massless_phase}
% \end{figure}

\section{Discussion}

\subsection{Finite-size effects}

Overall, the values of $T_1$ and $T_2$ for $q = \{ 5, 6 \}$ in this work agree reasonable well with the values found by
other authors, see \autoref{table:q5_previous_results} and \autoref{table:q6_previous_results}.

Finite-size scaling within the CTMRG suffers more from finite-size effects than finite-$m$ scaling does,
since with finite-size simulations smaller system sizes can be reached.

It is plausible that this is the reason that finite-size scaling yields values of the critical temperatures that differ
somewhat from previous results and the results of finite-$m$ scaling.

The discussion in \autoref{sec:finite_m_vs_finite_N} for the Ising model is applicable here as well. In summary,
the most straightforward way of improving finite-size results is to include finite-size corrections,
which should be feasible since the data is of high quality.
In conjunction with this, a more systematic study of the convergence of quantities and the location of the
pseudocritical points (extending results in \autoref{sec:simulations_with_finite_system_size}) may reveal that
simulating larger system sizes is in fact possible without too much loss of accuracy.

For finite-$m$ scaling, inherent deviations from the basic scaling laws, stemming from the underlying CTM spectrum, make
including finite-size corrections less feasible.
Using $m$-values that are far apart or that are specifically selected to mitigate the effects of the half-moon patterns
may yield better results.

Results for the exponent $\eta$ indicate that the critical temperatures found in both this study and previous work might
be too close together.
It is conceivable that, after considering larger systems and taking into account finite-size corrections,
both critical temperatures and the values of $\eta$ will be adjusted outwards towards their true values,
thereby completely reconciling the results.

\subsection{Other means of studying the transitions $T_1$ and $T_2$}

In this study, we have used the point of maximum entanglement entropy as a definition of the pseudocritical point.
The most obvious drawback of this method is that locating $T_1$ is not possible with finite-$m$ simulations,
as described in \autoref{sec:numerical_difficulties_t1}.
Finite-size simulations near $T_1$ are possible, but costly, since the spectrum of the corner transfer matrix decays
slowly for systems with a free boundary.

A different way of finding $T_1$ is through the higher order parameters
\begin{equation}
  M_a = \langle e^{i a \theta_0 } \rangle,
\end{equation}
which should obey
\begin{equation}
  |M_a| \propto \exp \left(-Ca^2 / (T_1 - T)^{1/2} \right),
\end{equation}
with $C$ a non-universal constant \cite{cardy1980general}.

$M_a$ is readily obtainable with the CTMRG method and does not require a free boundary.
However, it is not clear if this will increase the precision of $T_1$.

The transition $T_2$ may also be found by studying the magnetic susceptibility,
as was done by \cite{borisenko2011numerical}.
The susceptibility diverges more strongly than the entropy, but requires numerical derivatives to find.
It is plausible that this method would not yield a better accuracy than current method,
since it requires the same simulations to obtain $T_2$. Nonetheless, it would serve as a good consistency check.
